package com.advent

import org.scalatest.matchers.should
import org.scalatest.wordspec.AnyWordSpec

class FifteenTest extends AnyWordSpec with should.Matchers {

  def parse(input: String): (Array[Array[Char]], List[Char]) = {
    val sections = input.split("\n\n")
    val grid: Array[Array[Char]] = sections(0).split("\n").map(_.toCharArray)
    val commands: List[Char] =
      sections(1).split("\n").toList.flatMap(_.trim.toCharArray.toList)
    (grid, commands)
  }

  val underTest = new Fifteen

  "example 1" should {

    val input =
      """########
        |#..O.O.#
        |##@.O..#
        |#...O..#
        |#.#.O..#
        |#...O..#
        |#......#
        |########
        |
        |<^^>>>vv<v>>v<<""".stripMargin

    "move" in {
      val (grid, commands) = parse(input)
      var robot: (Int, Int) = (
        grid.indexWhere(_.contains('@')),
        grid.find(_.contains('@')).get.indexOf('@')
      )
      robot = underTest.move(grid, robot, commands)
      val newGrid =
        """########
          |#....OO#
          |##.....#
          |#.....O#
          |#.#O@..#
          |#...O..#
          |#...O..#
          |########""".stripMargin.split("\n").map(_.toCharArray)
      grid shouldBe newGrid
    }

    "part1" in {
      val (grid, commands) = parse(input)
      underTest.part1(grid, commands) shouldEqual 2028
    }
  }

  "example 2" should {
    val input =
      """##########
          |#..O..O.O#
          |#......O.#
          |#.OO..O.O#
          |#..O@..O.#
          |#O#..O...#
          |#O..O..O.#
          |#.OO.O.OO#
          |#....O...#
          |##########
          |
          |<vv>^<v^>v>^vv^v>v<>v^v<v<^vv<<<^><<><>>v<vvv<>^v^>^<<<><<v<<<v^vv^v>^
          |vvv<<^>^v^^><<>>><>^<<><^vv^^<>vvv<>><^^v>^>vv<>v<<<<v<^v>^<^^>>>^<v<v
          |><>vv>v^v^<>><>>>><^^>vv>v<^^^>>v^v^<^^>v^^>v^<^v>v<>>v^v^<v>v^^<^^vv<
          |<<v<^>>^^^^>>>v^<>vvv^><v<<<>^^^vv^<vvv>^>v<^^^^v<>^>vvvv><>>v^<<^^^^^
          |^><^><>>><>^^<<^^v>>><^<v>^<vv>>v>>>^v><>^v><<<<v>>v<v<v>vvv>^<><<>^><
          |^>><>^v<><^vvv<^^<><v<<<<<><^v<<<><<<^^<v<^^^><^>>^<v^><<<^>>^v<v^v<v^
          |>^>>^v>vv>^<<^v<>><<><<v<<v><>v<^vv<<<>^^v^>^^>>><<^v>>v^v><^^>>^<>vv^
          |<><^^>^^^<><vvvvv^v<v<<>^v<v>v<<^><<><<><<<^^<<<^<<>><<><^^^>^^<>^>v<>
          |^^>vv<^v^v<vv>^<><v<^v>^^^>>>^^vvv^>vvv<>>>^<^>>>>>^<<^v>^vvv<>^<><<v>
          |v^^>>><<^^<>>^v^<v^vv<>v^<<>^<^v^v><^<<<><<^<v><v<>vv>>v><v^<vv<>v^<<^""".stripMargin

    "move" in {
      val (grid, commands) = parse(input)
      var robot: (Int, Int) = (
        grid.indexWhere(_.contains('@')),
        grid.find(_.contains('@')).get.indexOf('@')
      )
      robot = underTest.move(grid, robot, commands)
      val newGrid =
        """##########
            |#.O.O.OOO#
            |#........#
            |#OO......#
            |#OO@.....#
            |#O#.....O#
            |#O.....OO#
            |#O.....OO#
            |#OO....OO#
            |##########""".stripMargin.split("\n").map(_.toCharArray)
      grid shouldBe newGrid
    }

    "part1" in {
      val (grid, commands) = parse(input)
      underTest.part1(grid, commands) shouldEqual 10092
    }

    "toPart2Grid" in {
      val (grid, commands) = parse(input)
      val part2Grid = underTest.toPart2Grid(grid)
      part2Grid shouldBe """####################
                           |##....[]....[]..[]##
                           |##............[]..##
                           |##..[][]....[]..[]##
                           |##....[]@.....[]..##
                           |##[]##....[]......##
                           |##[]....[]....[]..##
                           |##..[][]..[]..[][]##
                           |##........[]......##
                           |####################""".stripMargin.split("\n").map(_.toCharArray)
    }
  }

  "solve" should {
    val input =
      """##################################################
        |#...O....OO.#O......#...#........#..O..OO.......O#
        |#.OO#....#.#O..#O.......OO..O.O.O.O.OO..##..OO...#
        |#O....#O.........O.O.OOO.O..#..OO.O...O..........#
        |#........O...OO..O..OOO..O.O##...O.O...O..OO.O...#
        |#...#.#...#.#.O..O.....#...O..OO.O..O....O#..O...#
        |#.O#.O....O..O.#.....O..O........O.O........O..OO#
        |#..OO#O..O..##.......O...#...O....O.....O.O...#.O#
        |#....O...O......O#.O......O......O...O.....OO...##
        |#.O#.#O.O..O.#.OO........O......#.O.....O..O.#...#
        |#.O.OOO.......OOO.O.OOO.O.#....O..#....O....O..O.#
        |#OO.O.....#.#......OO.OO.O.O.#..#..O..#.....##..O#
        |#...#.O.....OO..O...O...OO.....#..O...#...O....O.#
        |#.O.O.O............OO.OO#..OO.#.O..#..OOO....O...#
        |#......#.O.O..#.#O....OO.......OO.O...OO.OO......#
        |#..O......#O...O.O.#..O.O........O......O...#....#
        |##O.O#.O#...O...OO..O......................O.....#
        |#OO....#..OO#O..O..OO.O......O.O..#...O..O...O..##
        |#.OOO..O...OO...O..OO#..OO#........O.##..O..#O.O.#
        |#..O..O.OO#...O...#O....O..O.......O..#.#.OO.OO..#
        |#O.O.O.OOO..#...#..O#O.O...#O#...O.O.O#O.OO.O..O.#
        |#O#.#........OO...#..#O#.O..#O.OO....OO..O#.OO.O.#
        |#O..OO..OOOO......O#..O.O#.......O.#O....O.....O.#
        |#OO..O#..O#....#O.....O....OO..O.O.O.#...#.##....#
        |#.....O.OO...O..O.......@....O...O..OO....O..#..##
        |#..O..#..................#............O.#..O.#O..#
        |#...O...O.OO.O..#..OO..O....O.O..OO.OO#..O....#.##
        |#.OO.O#.O...O..##..#..O...O.....OO#..#.O.O...OO..#
        |#OOO.OO..#OO...OOOO...OO...........#...#.O#..##..#
        |#.O...........OOO....O..O..#...O......O.O......OO#
        |#O.O..O.OOO#O.......#..O.O.O.OO...O...O..O#O.OO.##
        |#..OO.....O.O...#....O....OO.....#......#.O#OO##.#
        |#.O.OOO.O.O.#....O.#O.O.........O.#....OO...O..###
        |#O...O#O.....#.#O....O.....#...#O..O.OO..O....O..#
        |#.OO.O..#....#..O......O..#..........OO..O.O..OOO#
        |#O....O..O........O.#.O..........O...O...OOO#...O#
        |##O..#.....OO..OO...OO.......O..OO.OO.....#.#..O.#
        |#O..OO#O...#O..O....#.#.O.O............O..#......#
        |#....O.#.O.O...O...O.OO......#..O...#.........O#.#
        |#OO..O...OO.OOOO...OOO.O..OO.......O.O.OO..O.O.O.#
        |#......O....O##....OO.O.....#.#....OO#.OO........#
        |#...#.O.#.#....O.........#O.O....O#.O...O..#.O..O#
        |#O.#.O....O.........O.OO.#......O#..O#O.O....O.OO#
        |#..OO#.......O..........O..#.O..........O..#.OO..#
        |#..........#..OO.O#.........O...O....O#......#O..#
        |#.O.#.#.O.OO.O.O.OO...O..#O.O.O...O.........O###.#
        |#.OO.#.....#O.....O.OO......O..........OO#...O...#
        |##....O#.....O.....O....O.....O.O..O........O..#O#
        |#O.O..O#...O..OO..O.OO.O..O...O.......O..O.O.O...#
        |##################################################
        |
        |>>>>>>>>>^<^><v<>><>^^<v^v^<>v<>^v<^<^<^v<<><<<>><<v<<>><<<<<v><v<^v^v^v<<v^<^<^<>>^^vv^<<><<>^<v>^<^v^>v>><^>>vvv<<>^^<^^^>><v^v>^><<v<vv<>v^v<^<^^<>>^vv^>^>><>>>vv>^^^>v^v<<><vv<<^^>^<<vvv^vv<>v>>>>v<>v<<^>v>v<v<>>^v<><vv<vvv^><<<><v><<v^>^^v><>v>v>^<^^<^v>>^vv^^^<>^<^v^v<^v^<vv<>><>>>v>^><^<vvvv^>v>v^>^>^>>v^vv<v><v>^^<><v>^>vv>>^<^<^v^><<>^vvv<^v<^v^<<v>^^>>^><vvv><>v<v^>^v^<^<v^^v<vv>v^<<<^^^v>v^^>vv>v<^>v<^v>v>v>^<^v<^v^^>><>>><vvv>vv^^>v>^^>vv<^v<>v^v>^<^>vvv^>v<^>><>vv<>>^<^<v<>v<^^v^>v><<<v><^^>v^>>v^<<<^^^vv^<<v>^>>^>>^^^><<vvvv>^v^^^^^vv<^<^><v>v^>^^<v^v<^^v^<v>vv>^><^<<>>^>^^>><v^<<<<>><<vvvv^^<>>^>>v>><>>v^>^<>v<vv>>>^<><>^^v>^<<v<<><v<^<<><vvv^^^<vv>v<<<vv<v^^v^>^<>><><v^v><^v^vv>^v^v<^v^<^^>>v^^^>>v<<><^^v>v^<^^<<^<v>^<<<^v^>^^>vvv^>v^<vvv<>^^<<>^vv<<^>v^<><<<<v>>v^<^^v><^v^<><^v<vv<^>^v>^<<<^v^<^^<^<v><<<<^<^>>>^<v>v^^<vv<^vv<v>^v^v^^v^^<v><><vv<>^^^^><>^<^><^v^v<<^>^<^><><^v^<^^vvv>>^>^^^^v^>^^<^v<<v<vv><<>><^v^^^v^^v<<^^v<><<>v>>^<>v>^<<vvv<v<^<>v^<<>><>^<^>v^^>v><^><
        |^>>^>v>^>v>^^><>>^><^^^>v<^<>><^>v<<v^<v<>vv<^^^v^>^>v><<><<^>v<>v^^v<vv^>>v^>v^>>^^>v>^<^v>v<^<<^<^v<>v<>><><^vv<v<^^><>><vv^>^v^^v>>>>>v^vv<v><^^v^v<<^<^^^^<<vvv>>^^<<v>^>^^^<^v<v^^<v^>v<>v^><v<<<^^>v<vv>vv^>v>v^v^<<v><<^^v>^><v<>>vv>v^<^>^<v<v^^^<>v<^><<<^^vv><>><^v>><<^^v<v<><^v<>v^v^<v>^><<>^v<<<vv^><v^<^<<><^^<><v<^^<<v<>>^v^<v^<>>><^<v<<v<^>v<v>>v^v<>><>^vvv><v^<^<v^vvv<^<<<>>^<v^^v^>v<<>^>>><<^<>>>^<>v<v><v<<>v^v<^v^^^v^^v><^^v>^^>^>v^^v<<>v<<v>v^><v^>v<vv>><>^>>^^^<>vvv<v>v^^v^<^v^>>>v>^^<vv>^^>><^^>><><^>v<^>vv>^vv^>^^^vv>vvv<v<^<v<<>vv<^<>^><v<>^>vv^<>^<><>^>><^>^^v<v><v^<v>v>^<>^<^<^>><^<>>^^v^^>v^<^^^vv<<^<v<<v<><<^^>>>>>><vvv^^>>>v^><^^vv^<<<^<v^^^v^^v<<v^<>^<^>><^>^vv>>^>^<<^^<v>><v<^>^^v^>><v<^<<^<^v>v>v^>^>v>>^><^<>>>v>v><<<>^<v<>v>><<^^v<<v<>^<>v^v^v>^^v<<>><^vv>>>v^^>^v>v<^^^>>>^<^<^<^v>vv<^^<>>^vv<vv^<vvvv>v^^^<>v<>><<^^^^v<^vv^><^<<^<<^v^^<<^^>>>^>>v^^^v>^^^^><^>>>vv^^v<<v<^<v^>>>^v^<>>^>><^<><^<<v>^>v>v^^<v<v^>><^>v<<>^<>v>>>^^vvv<vvv^^<>v^v>^<<vv><>^v>^v^v<<v^>vv
        |v^>>>^^<<^<^<<v^>v>v>^<<<<><>v^^^>^>v>vv^^v<^>^<^^^<>v^>vvv^<^^^vv<>^<^>^^v>^^>v>v^vv^<^^<v<^>><>v>>^^v^^>>v>v><<vv>^v><^>><<><v><>^vv<>v>vv><>>><<v<^v<>v><>v^v<^^<<<>v><<vvv^>^><>^v>><>><v^><^>v>^>^<<>^vv^<v<^<v<^<v^>vvv^><vvv>^<<<<><^>v<><<<^<v^<^<^>^<^^<>v>><><<<v^<>^>vvv^>^>^<>^^^<^>^<vv<v>v><<v<<>v<v<vv>v<<>>vv^>v>vv><<^v^>^<>v>>^<v>vvv>^v^v^v^<<>>^^^^^<><>^><>v><^^<v^<^>v<^^v>v<v<v^^>>>>^<vv<v<vv><<^^>><v>>v^<>v^>v^<<^>v^<^<^<vvv<^v>>v^^^v^v<^v>>^^v>^<v<<>v^>>^v^v<vv><^^><^v>^>^^v<>^^^>^>v>^><v<><^v>>>v^><^<<<^v<<v>^^<^<vv<<>>>>v><>v^v^v><>>>^>vv<<v<><<^>>>>>^v>vvv<>>vv><^v<vv<<vv^>^<^^^^^><v^^>v^^<^<>^>vvvv^^>>^^v>vv^v<^vvv><<<^<<^v><>><>^^<<><^><v^>v^v>>v><>^<v^^<<v><^^v>^><v>^>v<>v<>><^>^^>^><<vv^v<v^>><^^^vv<^^^<>><><<><^vv^>^>^^>>vv^><>vv>v>v>v>v>>>^^vv^><^^^vv^<vv>^vv<>^>v>v<v<^><>v<v<v^^v^>v<^>^vvvv^<v<<<v<^v<<<<^^v><<<><v^>v^^v<vv^v<^>><^<<v<<v<^<^^>^>><<v>>>^^<<vv<^>vv^<^v>v>^v<^<<vv>^>v<v^>v^>^<^<v<v>^^^><<<vv^v<^v^^>v^vv^<<>v<v^v<<<<<v<^>>><vv<^v><^>v<<^^v^^><vv^>^<^>v
        |^v>v<^^<>v<><<<^><>>^^<v<>vv^>v>^<>^^^<v>^<<>^v>^<^<<v><<^>v<><v>>^>><^<>^v>vv>^^^<>v><^^^v>v^^>v>^^>^>>v^v>v^<v^<v<<vv>^^<v<^>v>^>^^<^v<^<<^>vv>vv>v>vv^><<<>v>^>vv<^><v^vv<<<<v>>v^<><^>^v^v<<^^>v>^v^^><v^v><^<><^<<><vvv^v^^<<<^<v><v^>>v^>^<v>^^>^<<^<<<><<>vvv^v<^vvv^>^<>^<<>vv<>><>v<^>v<v^^<^v^<v<<>v>>v^>vv<>v^^>vvv>>>^>><^^v^^>^>><>>^v>><><^>^>^v>^<^<>>vv<>v<><>>>^v^<<vv<v^^><<<<v^vv^vv>^<v^v^vvv<^v>><vvv<>v<^v^v^<^>^v^vvv^v<v>vv^<v^>>>v^v^v^^><v>><<>><>v><>>^v<v><vvv<v>^<^<<v^>v<<^<v><<v<^^^<v<^<v>v><><<><v^v<v<<v^><v>v>v>v<^^<>>vv<^^>vv^v>>>v><v^>v>^vv>>vvv^<><v>v<<v^><v><v<v^>>v^><>>vvv><<v>v><^><v^><<vv>^^v<>^<v><v<<<<^^<^vv><<^>>><v<<vv^^<<^v<v^>>^<^<v<v^^>^^<<^v^>v>><<<>^vv<v<>>>v<v>v>>^<^>^^^<<^>^>>>><>^>>^<>^>v><v^<<<v>>^>^v><>v^v^v^><^^v><<><>^<v<><^vv><^<<vv^v<><^<^>v>v<vv>v<>^>^^^^vv^v^<^<^v^>v><<<<vv<><^^^vvv<<^^<<^>v><>v^<^>>>^v^>v<>>^v><^^>^^>>v<^vv^<^<^^v^<^>^>v>v^<>><<<<v^>><^<^<^<vv>^>><>>v<><v<^<<^^<><^<v<<v^<>v^^<<<v<v>v>><>>vv><<^v<^v<^v<v^vv><>^<^>v^v<>^<<v^^>^><
        |><<<>^<^v>^<v<^<^v<><vv>^^v<vvv<^<>^vv^v>^>><v><>v<^<<^v<>^vv<>v>><<>>>v^>v^^<><>^>v<>v^>vv<v<>>>>^<><<v^>^<>v^>><>v<v<<^^^<^vv^<^^<<^^^v>>v>vv>^^<vv^<>>v<^^>v<<^<>>>>^^^^>>vv>^>v^><v<vv>>>>v^v^><^vv<^^^v<vvvv^v<^><<<<<<v>>>v>^v><<v^v>v^vv<<<^>^^v^^>^^^^>vv><<^<^^^<v><^<v><><v>><^>v<v>^>v^v<v><^<>v><^^<^^><v<>><v<vv^^vv>^^v^><<v><^^v^<v>^<vv^<<><>^>>>>>vv^<<<v>^vvv<<^^<v^<^<vv>^v>>><>>v^^>>v>>vv><<>>v><v^>^><^>v><^>^^^^>vv>^<^<v<v<<^^v<>^<><vvvv>>v^v<vv<v<><<^^v>^^^<>vvv<<>^<^v<v><<<^>v><<<^>>>v<v<vv>>^v^v<<<>>><^>vvv<vv<vv^<>^v^>^>^^^>>^^^<<vv>>>><<v>v>^^v<^^>v><<>><^^^><<v^>v^<^>^>^<>><<<><v>>>v<<><<v<v^><v<>>^v<v<v>^vv^^^^^v>><>^<^^v>^><<>>vv^^><vv^>><<><>v<<^^>>^<v<><>^^><>^<^<>vv^vv>^^^^<<><<vvvv<<^>>v^v<>>vvv<v^<^^>>^>^>><<v>><v<^vvv<^>>^v^^v>^>v^vv<v^v>^^vv^>^>>>^>vvv^>v^^>^v<>><<^^<>vv>^><>^v^>^><<><>^^<vvv^<^vv^^v<v>>>^^<<^<v<<<^>^^v>v^>>>^^v<v><<<v<<^v^^^^v^><^<><<>v<^>v>^<>v>^<<<v^v^^^>>>>vv<<<>><>>v>^>>>v^<<^>v>vvv^v>vv<<^><>^<<<v<^v^^>>^^>v>v^v^v><vv><^>><>^vv><v><^v<v>v<>
        |>>vvv<<<>>>>^<v<vv<<>^<v>^v>v>^^<>>>^^vvv>^<<<v><<>>^^<>^>><<>^^<^>v<<>v<>v<>^<><^vv^<>^<><vv>^v><vv^<^<<^^<^^<^^<v^<<><vv>v>><<<<>^v^><^>v>v^>^>v>^<<^<>^^><<><>v^>^<<><v>>>v^>v><<>v^vv>vv^><<^>^v^>vv^v<>^^>vv><><^<v^>vvv^<>v<^v<>^<^<>v^vv>vv>>>vv<^<v<>>^v<^<^<>><<>v<><v^^v<v^><v<^>^>^^^>^>><><^^vvvv>>vv<v^<>^<>v>>><v>>^<<><<v><<v^^>><>^vv^^>^^>>><^v^><<>^^v>^>^<<><<>>>>>vv<^>^^<^^vv<^^v>>^^v><vv<>v<^<<<<<>^><^vv^>><<^>vvv>^v^^<^v<><><><vvvv>>>v^<vv<<><^vv>vv<v<^vv<<vv<<vv><>>vv>^<<^^vv^><^^vvvv>v<>v^<^v<^^><>>^vv<vv<<v><<<v>>>><<^<<>v^<v<v^vv>^<>v<v>vvv^^<><v<>>^v<>><<^v^>>^^^v^^<^v<vv>^>^><>v<^^v>^<<v<<>vvv^v>^^^<<>v^^v<><>^^vv>v>v<vv>^^v^^>><v^<^>v^<>^<<<<v<<^^>vv>^v><^v<vv<<<^<^v>>><^<v>>^v<^<>^v<^v<^v^>v>v^><v>^<<v<vv<<^^^><>>v^<>><^vvv>>v^<^><^><<v<v><>^^<>v<v><v^>v<v^>^>^^v<>v^<v^>v<^<><^v<>^^>>^<>vvv<^>^v<^>v>^>v>><<<>>v>^>^^^>>^v^v<<>^v>v>v><<<<<v^^v^<v>^>^v><<>>>^>>v>>^^><^<<<v<<<<vvv^>^><v>^^<^>>^^>vv^v><v^><v>v^<^><<>^v^><v^vv<^^v>v<^>^<><^v<^^>^^>^>^>>v^v>^><^>^vv^><<^>v<v
        |>^v>^^^^>>vv>v<v><<v<<<<<<>^v^><^<<^v<<^v>><v^^v<v<v<<><<<^<v<<vvv^<^><^<^><^v<v>>><<v>^>vv<v>^>>v<^vvv><vvvv>^><>>>>^<^<><v<>^<^^v>>>^<<vv^<<><vv<<<^^v<^>vv^v<>v<<v><v<v<v^^^v>><^<^>>><><<v<^^<><v^v^><v^v<<<v^^v^<<><^<<>>^<^<<>v>vv^><^^<<vv^>^v<<>^^^<^v<vv><<^<v^>^vvvvv<^<vvv<^vv^<<^^v<v<v>v<^>^<^>>>><>>>^v^<><v>v>^^^^v^^vv><<<^<<<>v^v<<<vvv^vv><<^^^>><v^^^^<^v>><^<v<v>^>>^><^v^v^vv<v>^^v^<>v>><<>^v<^vv^<<vvv<v>^^v>^^>^>v>^v^>v^>v^v<^^>v<v^<><<^^<vv<^v>>^^><<vv^v<vv>v^<<>><>^^v>>v<^>^^<<^^v^>>>^v<v>v^^^^v<>>^v><>v^^>v>v><v^><<^<v>>^^>>v^<>>>^<v^v^<<^^vvvv>^^vv>^^^><^v>^v>^^v<v<<^vv>><v<^^>^<v>>>^<^<<>>v<^>>><<<v^^>>^^vvvv><>vv<><v<v>v<>^<v>><^<><v^^>^^<<v^<<^<vv^^><<^^^v<>^^vv^v<<^^<<^v^<v^<^><^<<><^^>>>vv^>^v>v^^^<^^^^>v<^v^<^>v<v>v^><vv>v<><<<^>>>^^<<<v<v><^v><vv><v<vv><>>^vv<<>^^>v>^^<v^>>^>>v^^^^^^<^^<<^<^<^<^vvv<<v^>>v^<<<>v^v^><v>><<vvvv<><><^>^v<^v>>^><vvv>><>v^^>^v<<>>v<<<>v<vv<>^v<v^<<^^^^^>^<vv>v<vv>v>>^vv>v<><v>v^<>>v<>>v>v^^^v>>>>>v^>vv^^^v^^>>^>^v<^^>v<^><>^<^vv>>^^^<<v<>
        |vvv^<>^v<<^^^v><^vv>vvv<v>>>^^<v<<>><><v<>v<><^<>^^^^<^>^^^^<v^^>v<^<>vv^v>v>v><><^^>>>>>^<<v<>^^^<>v^^>vv><<<>>vv<v>^>vv<<>v>v><^v<v<<vvv<<^^^vvv^^<^vvv<<><<^<v>>vv<>vvvv>vvv<^v<>>^<^^v^>^vv^^<v^<>vv>>v<>v>^v^vv^>^v^<vv>^^<<^v^^>><>v<vvv<vvv^^vvv^>^^v<<^>v^<v>v<>^^>>^<>>v<<>v<<>>^v^><>v^^^^^><><<<><v>^^vv>v^>^v><><^v^^vvv^>>v^<v^^vvv^<v^^^^^<>^v^v<^vv^^<>v>v<v<v><>>^>vv^><vv><v^v^<><^<^>>vv<^vv>^v>^<v^<v^^^<^<^>^v>v^<<vvv<v^v<vv><v<v><>^^v^v<^>v<<>^^<^>><<<^<vv^v><v<vv>^v>>>>><<v^v>v<vvv>v<v<>><<v<^v^v>>^>>>v><><^v^<v<>>vv^<<v^v>v^><v^>^>><^<<^>>>>v>><<<>v>v^v^>>v^v^v<<^^^<<v>>>^<v>>v<>>v^v<<>vv>^^vv>vvv<v^vv^^v<<v^>v<<^v^vv<><<v^vvv^v<v>^^>^v^>>^><><<v<vv<v<>^>v<v^<^v><^vvvv>^v^><v<v>v<v>v>^<v^<>>^<v^vv<v><<v>><<<v>^^>^^^>>v<<v><>^vv>^>>^>^v>>>v<><>><v<<v>v>^><^<vv^v^v>>>>>^^^<>v^^<>vvv^><>><<<>v^<^v^^<<>>v^^^^>>v>>>v^^<><^>vvv^>>v^<<><vv<^v>>>>v<vv<<^^^<^>^^vvv^<><<v>>v<^^<vv>>^vv<<^^^^>v<<><^<<>><<>^v>v<><<>vv>^<><vv^vv>>v^><>>vv<^><>><^>^v^>>>^>>v>>^v>v^v>vv<^<>>>><^>>>v^v^<v<>^v^
        |v^^^vv<>^<>><v>^<^^v^^^<^^<vvvv^<>^v>^><v>v^><v<>^v<v><vv<<<v^>v>v><vv>^v>>><^^^><<vv>^vvv^>^><^^<^v>>><^<>v>^^<<vv^<vv^^^^^^v>><<v<v<vv<^<^vv<><v<vvv^>^^>v<<^^v<>>>>^vv^<^><<v^>v^^<^<^v<<>><^>^<v^vv<<>^><>>^vv^>vv<>>v^v<>><v^<v<v^^v<<v<vv^>>>v<<><^^v<>v<>v>>^vv<v^<v^v<vv^>>v^v<<>>vv<<^>^<<v<v>>^<v^v^^<vv^^^vvv>^^vv^v^^v<v^>^vv<<^<v<^>^^>v>>v<>^>><<<v^^v<^<>v<v^>v>vv^>^>>v>v<<><^>^<<^>v>>v>^vv<<^>v>v<^^><v<v^<v^^v<^vv<^<<<v><v^>>^v^<<>vv><><v><v><><^>^>v^^<>v>>>v<><^>>vvvv<^vv>v^^^>><<<><^vv^^^v^v<>><^>>v^v^><^<^<<v>v<vv^<>vv^v<^>^>v<<<<v>>>v<^^vv>v^v^>^v>><<<v>^vvv<vvv><^<v^^^>^<>v<v>^^^v>v>^^>^>^^^v<>^v^<^v^>^>><<>^v<>v^><>v^>vv^^<^>v^v>^vv^^><^<<<<><>^vv>>>^v^^>v<^><>^<^<<^v>v^vv><><<v<v^>v>><>>^^v^>^^v>><vvv>^^<^<<<>>v<<<^<><>v^vv<vvv<>^^<<>^<<<<^><v<^><>^>>^vv^<>v>^^>v<><<^>><>^v<v^v>v>>>v^^^v^>v><>^v<<><<<><<v><^vv>^>v^<v<v^>>vv^<^><^<^<v><>^>>>v^>^><>^v<vv>><^vv^^<vvv^<vvv^<^<>^>^<vvv>>^<<<^v>v<v^<>^^>>>v<>^v<<^<<^>v>^><^<<vv^v^^v>vv<v<<>^<>><>^^><<v^><^^>v>v><v>>vv<>><<><^<<<v<
        |^v^^<v>><^><v^vv^<<^^v<>^v<>>^v><^<>>^<>^v<vv<>^vv<^v<v><<^v^^v>^><<<>^v^v><<^<>v^v^vv<<>v^><><v<<v<<<>v^^v^^<>^v>vvvvv^^^<^^>>>v<>^^<^^<><<>>v<vv<<>v>vv>v><^vv^^<^<^<v<<<^<<><><<^v<^>>^v>vvv<^^>>v>>vv<v>>>^<><<<>v<>^vv^><v^>vv^>v<>>>^v>>^<v^<<v>>^^<>v><^v<vv^>v<^^v^v<v^^vvv^^v>>>><vvv><>v>v<^v<^^<<^vvv^^<<vvvv>>><<><><^^<^>><>><<<<<v^^^>v^>>>v>>^<^vv>>><^v<>>^^v^v>^^<^<>v^>^^><v^><^^<v^>>><^>v<<<^^vvv><^^v^<>>v<<<^v<<>>vv<v>^><^<<><v^<v^v^^^v<^>vv>><v>>vv><<<<>^v><^<>vv^vv<^v<^^v^^^^>v>vv^<v>^>^v>v^vvv^<<vvv^<>v^<v<v>>>>><^<v>v>^^v>>^><^^v<>v^v^<<<<>>>^v<>^>>^<vv^v>^^>v^<^>^^>><v>^^^^^<^<^v^>v>vv><vvv^><^<^^><v>>v^v<<>^<<>><v>^^^v<^^<>v^^^>>><<^>><>^>>v<<v<^vvv<<^><v^v<>v<<^>v>v><<v^>>^^<v>>^v^<<><>^^^^><<<>^v<v<<<vv^v^vv^v^<>^v<^^><><vv>>vv>^^>^^^v<><v^v<>^^>^<^v>vv^<<<<v>><vvv^^^^>v^<^^<><<<<^<^v><^<^v><>vv>>v>^>>^v><>><>^>v^>v>v<>^v^^v^>>>>>><v^v>^v^v>v><<^v<vv^<><vv>>^<>vv^v<v<>>>^v<^^>^>v^>><<<vv^v<^v^<^<>^^<>^>v><<<^v^^^^v>>>^^^v><^^v<v>>v^<>^v><v^^>^v<<><^v<^v<>v^v><^^v>^>^v<^<
        |<^^vv>^<v>^<<v<><^<^>^<v<>v>^^<<>^<^<>>^>^<<^<^v>^>>>vv<^^<<>^><^^<>><<^^>>>v^>^<<^>>vv^><^v><v><vv^>^>>v<><<><<^v<>^^<<>v>^v<^^^<>^^^<v><^<>><<<<<>v^^<<<v<>>^^v<v^^<^<<>^>vv>>v>^><v^>^<><<>v<^v^^v<vv><>vv>v^v>><>>>>^>v<><^>v>v><vv<^^>v>vv^v>v<<>>><vv>^^<<><v^v<<<^>^v<vvv^>><vv>^>^<v<^<>v^<v^v^>^<^^>>^v^<<vv<^<>>v^^>v^><<v<v^<v^<><^<v>vvvv>>v^v^vv>^v>^vv<^>vv<v^<>^v<^<v<>>>>^<>v^^><^<<^vv<^<^v<>>>^<<v>v^^^vv>v^vv<^>>vv<<<^>v^^>^><v^v><<v^<v^vvv<^v<^v<<^<^>>><v><^vv<^<^vv^>^vv<^^vv^<<>>vvv^v^v<^>^vv^v>vv>^^>vv^vvv^v^^>^vv<^^>v>>>>^>v><>><v^v>vv^^^<^><vv>><v^>v>vv^>vv<>^^^<>^^v^>>^^><>v>>>v>vvv<v<<v^v^v^><<>^^^^><<<v^vv><^><>^v^^<<<>><<>><v^<^<><><>>vv<<<v^>^^v>>>^^v<^<^^^^<v^^>vv><>v<^^<>^>>>>>>><vv^^vvv^<vv>>vv>^^v>>^<<^^<vvvv<^<>^<v<^>v>>>^<v<^^<<>v<<^<>vv^<vvv<>>>^>><^>^<vvv<>v<>vvv>>^>^v>^^v<vv<v>>>^^<<>vv>><vv<^<v>^v><^<>^<>^v>^^v<v>v<v<v<<^vvvvv<><^<v^><<>v><<>><<^><^<<^<^v<><^><<vvv^<<^<>v<v<>v>>^^^<>>v>v<^<<>>v^><v<^v><<<<>>^v^v>^^<>>>^<>v>>v><<^>^<v<v<>>^<<>^>vv<^v<>>^>v^>^vv<>
        |<<>^<>v<^<>^><vv^v<^^v^<<>>>^<<v^<vv^><v^<^>^v>><^>v<^v<<<v<^v>v^v><v<<v<v^<v><^>^^<vvv>v>>v>v>v^<^v^v<<^>^<v>vv<v>vvv^^<v<v^<>><>^<v<<>^^v>>^<<>vv<<v>>>>v^>^>v>vvv>><<<<^v<>><<vv>>^^^vv<^><<><<>>v^>v^<^v<^<vv>^><>v^vv>^^>>v<^>v<>>><^vv^<><v^<>>^><>^>v<>><^<>v^>^^v<<<^v<><^^v^<^^<v^<>>><v<<>^>>>vv<>^<^<>>vv^<v<v^<<<<vv>^^>v>^v^<>v^<^v<><>vv^^<<v<^v<>>^<v<^^>^>v<^>v<v^vvv>v>vv<v^^<<>vv<>v<<^<<<<>><^^<^<^<<^<v^^<>>>>>v^v><>^<>v<^<<vv<>v^^<><^>^v^^^v<^vvv<v<>v>>vv>v<>><>v<<^<>v<>>><v>v>^>v<^v>>v<<>v>>^v>^^<^^<v^vv<>><^^<<^^>v<v^>v^<^v>>^>v^vvv^<>^>vv^vvv>v<>><<<^^v<<^^v>>>^<v<^><v^v>vv^v^<>>v<>^^><^><v^<<<>v><<^^><>>v^^v^v>>>>^^v>^^><v^<>>>^<v>v<v<<>>^v<v>v>v<>^>v>v^v<^^^>><<<>^v<vvvvv><vv^^<^>>^<><><>>>v^><<^>^v^<^v^<<<<<^<v^^>><v<^>v^>v>^v^>^^vv<vv^<<v><<<v>v<><<<^v<v^vv>vv<>>^>^v>><v><<<v^<>^>^<^<^^v^<v<><v<><<^<^^>v^^>v^><^v^<^v^><^^<>^>>v<v<v>vv>>>>vv>><><^v^<<^<^^v^>>vv><^^v>v<>v>vv^<^<<>vv^^><><>>>^<^<^v^<v>^>v^<v<>><>^<>><^>v<<^<vv^>v^^>v^<v><v>>^v>><<v<vvv<<vvv<^<<^v><^<^vv><<>>^
        |^<^>>><><>vv>>v>v<>>^<^<><>v>v>>vv^^^vv^<^v<<>>^>^^v^vv>vv<v>>><<vv<<v><v^v^^>v<v^><vv<vv^^v>vv<<v<^>v^^>^v>>^v>^><<<<^^>^<vv^<^>v>v^<v>><^v<v<<<<>v^<>><^v<^v>^>>>><<<^^<<v^^<v^>^vvv>v>^^>v>^>>><><>>vv<<><><><>vv>^<v>vv>>v<v^>v^>v<^v>>^^v^<<^v^^v^<v<><v^^vv<^^<<><<v<vvv^<^v<>><>><>^>^^>^v^>>>>><<>^>^v<^<>>^^<>>^^>^v^>v^v><v^v^^><>^^v<^^^^vv^^<^<^<^^^^<>v^v^^><>>>^<>^^v<>^>><<^^<<<<><v<<v><vv<<vv<<^vv<<<^><^><vv^v<<>vvv<<<>v><vv^vv<^>>v<v^>v><><>>v>vv><v<^<<<><>^v<<>>v>vvv<<^v^vv><<v^>><v>v^>v>^v<^v<v<^v<>v><v^^><<^<><^^>^>^v<^<>^^<^>v>v<<vv^^v>^v<>><>>^v><<>vv<>v>v^<<v<>><vv^<vvvv^<>v^^v<^<v><v^v>>^>^>>v^^^>>^>><^vv>><^^><v<vvv>>><v^<v^v>>><<<v>>^^v<<>^^v^<vv>>^>^v>>^^>^>^>>>v><^<><^>^<<<vvvv^>>^<vv<>vvv^vvv^><^<><><v>v<>>^<<^>><vvvv>^v>>^<v<><v<^<>^^<vv<>>^^<^^><v^><>^^^v^vvvv^^^v<vvv<^><<^><vvv>^v<vv<<v^^v<>^^<v^<v<>^v<^>^><>^>><>^v<v^>>vv^^><vv^v^v^v<<>>vv<<<>><>^>vvvv>v^v^v^>v><v<>v<<vvv<<<^><<>v<<<<>v^^^>v>v<><^<<v<<^<>^v>^<v^<^>vvv><<<>^<><^^^^^vv^^^<^<^<v<><^>^vvvv<^<<<^<^<^<>>v
        |<^<<v>^>v^>v^>^v<><><<^>v<>v><v^v^<>>^^^^v<>^^<<^<>>vvvvv><vv^>vv>v^>^<>v^v>^^>v^vv^>vv^<>^>>^^^^vv<<v><<<v<v>^<<^>^>^v><<v<v^^^><>><>v<v<><<v^^>v<<^v^><>^>^><v<<^^v^<v<^><v<>>^^v<v^>>^^>^<<<^>^^vv<<>v<<v<<^v^>v^><v<<<^<><<^<v>v^vv<<v<vv<>v<v^^>^><>>>>>^<>><><^><v>v<^^^>^<^>vv<^<<v<v^vv>v^>vv^^>>^^>^>^><<<vv<>^vv^^>v>v<<>^^^<<^^>v><<^><>^<^>v<<^v<>v^>^vv^^<^^<>^<>>^vv>>>>>v>vv>>>^<<v<^^><<<<^<v^<^v^>>>vv>>v<v><<>^<^<<^v^>>^^v<^>v<v><v><v^^vvv>>v<>><>^v<v>^v<>^v<><^v<^<v<^>^v^<>^v>>>vv^^>^>vv^v<^v^>^vv>>^<<>v^v>vv^>>v>^v<v^<^^v^v>vv^<^<<<v>v><<v><^>^v^v^<<v^^^<v><>^v^^>v>^<<>^<<^>^>v<<^^^>v>^^v<v<^v<<v<vvv>^>^><<>^^v>vv<>vv^vv<>>^^^<^vv<v>^^>><>^vv><>>>^>^^v^><>v^v^<^<^<vv><><^^v><^^^><<v>v<<v>>v^>^><><^<<^v^<v>v<>>^^<<><>vv^>^^^<<>^<^vvv>vvv^v>>^^<<vvvv^<<v^<v>v<vv>^^>^>v<^^v<<>v><>^<>v^^^<vvv<>^^v><<v>v^<^v<v>^^^<^><^v<<vv>>>>^v^^<<>><vv><><>v>^<>>v>><>^vv<vv><vvvv<>>^<^<^>>^v^>^v>v<>v<><>><v<vv<v>v^>v<^>>v<<v^^>v><^>^>v<>>v<^<>vvv^v<<v<v^vvvv><v<^>^v^^^v>^><v^^^vvv<<vv>^<<^<<>v^v>^^>
        |><v^^<^<^vv^>>v>>^>v^<>^^vv><>><^v<<<>^>><^<>>^^<^><<<<>>^^>v^v>v<v^^v<^v^v><v^<>v<v^<<^<<^v>>v>^v<vv>v>><^^>v>><<^<vv^v>><><<v<^vvv>>^v^^vv<>>>><^<^><>v<^^><<<<>>v^<<><^^vv^^v^^<^><<v>vvv<^<vv<><^vv^<vv>v>>v>><v<>^>>vv>v^<v<<<v^>^<>vv<v^>vv<^^><^<><^>^^>>>>^>>>^<vv<<v>v><<^v^^><><><^>>><>v>v>^>v<<<>v<v<v^^<><>v>^v<>^<<<^v>>v>v><<>^>^<>v<^^>^^v^<>^<<vv<<^>>v^><v>^>><^v^vv>^^<v>^<v<<^<^^>^^v<v>v><v<<>>>^^>><>v<>v<^>^v><>vv<<<v>^v<>vv<v>^v^>vv^><^vvvvvv^v<v>v<>^>vv>v>><>^v^v>v<^<^^<vvv<^v<^>^<>^^v^^<<<v>>vv^^>^<>>>>^<v><>^^<vv>>^v<<<>>v>^<^>vv><v^^><v>v^>><v<<^^<>v><vvv<v^^v>^^v>^^vv^>v><>v<^><v<v<^><<><<<<^<>^<><v^v<v>vv>^^>>v<^vv><^<v^<^<v^v^v><^<>v^v<><>^^>>>v^>>>>v>>^<^<^vv>v^vv>v^<^<><^>>v>^<<><^<v<<v<<<^>vv<^>^<>^>>v<^v><<^<<vvv<><^<<<^>^<<^^<>vv<v<<>vv^<^v^<<<>><^v<v<<<<v>^^^<<<vvv><><<><v>>vv^^v<v<v<^v<<>^^<<>><^v<<<<<>v>^><^>>v^^>^^<<^<^^^>^>^>^><v>v^^<><^<<<>^<^>^<<<>>v^vv<<^v<^>>vv<<v^v<v^v>^v><>^>vv<^v>vv<><<>v<v<vv<^v>^^>^v<^<^>^^v^>v><vvvv><^<^>>>><^^<>^^<<^vv^^v<^>v^v>>vvv
        |<<^<v<^>><<><^vv><<<v^<^^^vv<>v<^vv>^v>^>vv<<v>^vv^^v>^v>^>><v^>^^<^^v^<^vv<>v^<<^^<<v^^<^^><v<<>vv<v<<v<v<v<<>^<v>><<^<v<>^vv^v<vvv<>^<<<^^><v^v>><vv^v^<v<^<<^^^v^^vv>>^^>^vv>^^vvv<^<<v<v<<vv<^vv>^>^^^<<><vv><><^v<^^>v^v<^>^>v<v<v>^<>^<>^><<v><v>>v<vv^vv<^v<>><^><^^>><><<>^^v>>>>v><v^>vvv<>>^^^^<>^>^v^v^^^><^^^v><>v<v<v<>^<^^^^<>v>v<<v^>^>>^<<<^<<^>>>><^<v<<^>vvvvv>>>^<^v>>vv^>v<v<>^vvv>><^^<<^<<>^>^^<vv>>^<^^v>v>^vv><>v<v>v^<><<^v><vvv<v^<<>^^vvvv<<^^v>v<^<v<^<<<v>^v><v<^^^>>v<^^v^v^v<v^^v^^^<^><^v^>^>vvvv^v^vv><>v^v^^<v^<<^^<><<v<^v><>^>>>v<><<><^<^^^><^<vv><<><v^vv>^^v>>>>^v^<^>^^>><^>>^v<^v><>>v>><^^>>><<<<^^<<v<^<>vvv^^<vv<>v>^>>^><<<^<^>v^>v^^><<^>^^^v<<^<v>v^>^vv^^vv^<^>>v><v>^<^v<<>^<v<^<<^^>^>v^><>^<<^>^v^vvv^^^^^v^v<^v<v<v^^>>^>vv<^<v^v^vv>>^>^>v^^<^^^>^><^><<><v<v<vvv^^>v^<>^^v>>vv<v><<<>><>v>^<^^>v>vv^vv<<^v<<v>><v^^v^^<vvvv>^^^>><<><<^^><vvvvv<v^>v<^^><><><<^>^^<v<^v^vvv<v>v>^v<<>>v^^>>><>>v^v<>v<>><><<^^^v^<<^<v^<^<<v<^^v^<v^><v>>v<>^><^^^v^<^<<<^v<^<v<>vvvv>v>>>^vvv<v<>
        |v>^<^>^>^<<>^^>^^v^vv>>><v>vvv<^^<^v><>>^^v><v<<v<>vv<^v>>v><>vvv>v>>>v<v>vv<v<v^^>^vv>v<^>vv<v>v^><^<<v^><^v<v<<^><<v>^^>>><v<>>v>vv<^<<<^><v>>>v^<v^<v>vv><^^v<<><<<^^<<v<<><>^v^v<<v<v^><^>v<^v><^>^>><<>^^>^><v>^v<<^^>^^>>v>v>v<^^v>^>v>^vvv><<^<v<>vv<^<vv^><v^^^^v^<>^v^v<><v>vv<>vv<v<^<>^v>^v^<vv>>^<^<<^^^vv^><vvvv><vv^^>><v^<^v^^<^<v^>^><><<^vvvv<><<>^^><<<^>vv<^v>v>><<>vv^^<^v<<><v<>v^<<>^<vv^^><<^v^>>><>v^>^^>>vvv>v>><<v^vv^<><v^>>v<v<<<<<><^>vv<<>^^v<>>><^^<>vv^<v^v><v<<>>v^vv<>^>v<^v<<v><>v>vvv>v>^>^<v><<^v>v^^<^>^><vv^>^>><v>>>>v<<>^<>v^^<<><>^<vv<>^v^^^^<^v><^<<^<>^^^<^>^>v^^v^^<>^vv>><><>^^<<>v<v^>vv^>^vvv><v>v>^vv>v<>vv<v<><<v<^<<<v><<><^>>vvvv<^^<^v^<<^<><v^^^><>v^^v<<v<<>^>^v<^<<v^<^^^<>><^><<<<>v<v><^v>v><>v<vv><<^<^>^v<>v^>>vv>^v><^<>>><^v^<^^<>v^v^<<<^v<><v><>v^vv^vv>v^>>v<>>><>^><vv^<^<><<>v<v>>v><<>^^<vv<v^v<v>v<v<^v<<v><^v^vv>^vv^>v^^^^^^v>>^v<<<<v<<v>vvv<^vv^v^>^>>v>>><>v<vvv<v^^v<vvvv<^^v<^>v>>v^<^^<<<v^v>vv>v^<><^>><<<>><v><>^>v<^<>v^^>>>v<<^^v^<^^<>><^>^>^^>>><<v^
        |v>>^^>^><^<^>v><<>^>^<^^v<>^>v<>v<<v>><^v>v<>v^<v>^vv>>vv<^^v>vvv<vv^<^vv^<v<v^^^>>v^^v>^vv<>^<<<<^>v<v^v><^>>><^v><v^<v>v>><v>>v>>v>v>^<>^<^^v>^>><v>v^v>vv<v^<v^^v<v>^><^>vvv>^>>v^v^<<<>^<v<^>^v^^<<vv<<<>^<<<>vv>vv<v>^^<^<>vv^>v<^^^v<<^<^<><>^vv^vv^><vv<>vvvvv^<^^^v^^<<^^<>^^<<<>^v^>v><>>>vv<v<>><v^v^><^^>>vv>>^<^^<^v>^>^<><^v^^<^vv>v<<v>v^<^<^vv<><v>v<v^v><<>>^v<<^<v^<>>>vv^^<<<v^<<>v>^<><<>vv><^^v^v<^^^<v^><v^>^^><^>vv<v<>><v<>^^^^vv>^<<^<^>^v>^^^v>>v<v>v^v<><>^<^><>><><^>^<v>^><<>>vv^>>><^v<<^^>^^><>v<<^>>v<<^vv^>>><<>vv<>^^<v>^^^<^v>v^^vv>^^^<^^^vv>^^v>vv>^v^>><v><^>>v^^<v^^<<vv^^<v^^^vv<<>v>><><vv^<>>^v>v>^<>vvv^<vv>^v<^>><>v><>>v^<<v<>^<<>^^<<^^>vv^^<>^>^<<>^<v>vv>><<>^v><<<><^^^v^^><<v<<><v^^^>><v<<<^>^>><v>>>v^><<><<^v<^v<>v>><^>>>^^v^<v><v>^^<v>>^<>^^^^>>v<<<^^^vv<^<<^^v^^<^v^<^v<><>>>^<^^v<<v><<vv^>v>v^>><v<<<<>>v>^<<v^^>>^>^<^>><v^<>v^v^^^>><>><><><^^<<>>>>>vv>>^<><^<><><<<>^><v>vv<v><^v<^^<^v^>vvv^>v^>>><<^^^><vv<<>><^><^<><<^<<v^^<>vv<^v>><<^<>^^<>vv>v<>^>>vvvv^>^v>v><>^v
        |><^<^v^^<>vv><v^^v>>v<^v>v^v>v>v^^>v^<v>v<>^><v><^>>^><v>>^v<>v^^v>^vvvv<<v^>v^>v^<>>^^vv<<>v^v^<>v><<vv>>>>>>^^>>^v^>^<>><v>v>>^^^v^<v><^^^^v>vv^<^>^v>><^<<><v>v>v^>^>^v>^><>vvv^v>>^vv^>^vv^^^^v>vv<><>>>^<^^>>^><<<><>^><>^^v<>v^><^>v>>>^><v^>v^v<v><v<<<>vv^^<>v^^^>^^^^>>>>>v<v^v^^^^v>^>vv>^<^>^v><^^><^v>v>^<>^<vvvv>^>v<^v><v<<^v^<^^^<vv>vvvv<>^v<><v^<v^<<^v>^<^<^v>^>v<v^<v>>^^>^vv>^^<<v^vv>>>v>^<^<<^>v><>>>^vv<<^><>>v^>^<>^v><v>>>^<<v>vv>>^^v<^><^vv>^<>v>^<v<^<><>^<^>>>>>><<>>v>>v<<^>^<>>^<^><^>^<^^^<>>v<>^^><^>>vv<v^vv>>>>><^<><<<^^><^^vv>^v^<v^<<^>>^<^>>^>><<^>v<^^>v<v>v^>^>v>^v^vv^>v>^^>>v<>^>>v>>v<<v^>>>^^<^v<<>>><>>vv<^>^^v<vv>vv<v<^<v><>^v>v^v<v>><>v<^<v^v<<>v^v>v<>>^v<v^v^^<vv^>>^^^^vvv<<^v>><^^>v^<v^<>^<v^<<<v>^v<>><<v^v<v>^>^v^vvv<>v>^>>>v<<<v<v<<^v<>>v>^<><v<<<^v><>>^>v<v^>v>v>^^v>^^<^^^<vv^>v<<^<^<v<^^^<v<^v^^v^^^vv>v<v>v>v^><>>^v>v^<^^^vvv>v>vv>v<vv>^<v>>>^v^<>v<>><<<>>^v^^^<>><>>v<>v<<<^>v^><v<^>v<^<<<><^<<<v^>>^<v<<>^^v><<>><vv^><<^<><^><>>^>^^<v<<^vv<^>>vv<><^v^v>^<v<v<
        |v>><^>^<<>>>^v^<vv>^v>^v<^<><vv>^<<v>>^><v>^vv><v>>^<^^vv^<vvv>^^<v<^v<>^>^<^<<vv>>>^>vvv<<^v^><^v<>vv>^>v>^><v>vv<vvvvvv<>vv^><><^>^v^<<v<^^vv^^^>>><^<v>^^><<>v<<^<v>^^<^<><^v<v<^<v>>^<<^^v^<><>vv^v^^vvv^^^><vv><<^^<>>^<^v^vvv<^vvv^v^^>^v^^<^v>^vvvv>^>v<<>>>v>^v<><^^^^^<^<vvv^^^v>^<^v^<>><<<><v<<^<vv>>^>^^v^^><<<^^vv^<^<^<<v>^^<>vvv>v<vvv>^^v><>v>>v^><>>>><>vvv^<<^<>>><v<^v<<>>^<v<>>v<<<v<>^^^v^^^>^<<<^vv<^><v>>><^<v><^<v^>v^<^v^>>v<<v^>^^>^^v^^^^^>^>v^v^vv^^>v^v<vv>>>^vvvv>^<<<<>v<>v<>v^>>><v<v^^<>>v<^vv>v^>><<>vv^^v^v>v>v<>v<>^>>vv^<>v><<v^vv>^>>vvvvvv<v<>vvvv^^v<<<v<>^>^>>>>^><v^>><^v>><v^vv><<<v>^v^^<^vvv^^v<v^<vv<v<^v^vv^v>v^>><v>vv>^>v^v<v<^v>v>v<<<vv><>vv^v>^>v^^v^<vv>v>>^vv<><vv<v^>v^v>>^<>^^><v>>>>vvv<v<vv>v^v>v^>><vv><<>>^<<<>v>^v^><><^>^^^<>v^^^>^><^v>^^v^<>>>><<^>v>v><^v<<^>v<<<>^>^^^<>>v><<v^^><^<^>><<v<>^v^v^<<>>>v^><<v<v>^v><>v^v^><<v^>><v<<^>>v<>v>^v><<<>^><^v<^^<^<^>vv^><^<v<v>v<^>vv>><v<>v><<^>vv>^<^>^vvv^vv<<<><<>vv^v^^vv^vv<^><<>v^<vv>v<><>v>^><<><<v^^^^v^>>^>>^v^v""".stripMargin

    "part1" in {
      val (grid, commands) = parse(input)
      underTest.part1(grid, commands) shouldEqual 0
    }
  }
}
